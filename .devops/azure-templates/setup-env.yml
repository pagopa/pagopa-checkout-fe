# Azure DevOps pipeline template used to build bundle.
parameters:
  - name: 'api_host'
    type: string
    default: ''

  - name: 'request_timeout'
    type: string
    default: '5000'

  - name: 'polling_interval'
    type: string
    default: '6000'

  - name: 'polling_attempts'
    type: string
    default: '15'

  - name: 'env'
    type: string
    default: ''

  - name: 'site_key'
    type: string
    default: ''

  - name: 'functions_host'
    type: string
    default: ''

  - name: 'api_timeout'
    type: string
    default: '10000'

  - name: 'api_basepath'
    type: string
    default: ''

steps:
- bash: |
    echo 'IO_PAY_PORTAL_API_HOST: $IO_PAY_PORTAL_API_HOST'
    echo 'IO_PAY_PORTAL_API_REQUEST_TIMEOUT: $IO_PAY_PORTAL_API_REQUEST_TIMEOUT'
    echo 'IO_PAY_PORTAL_PAY_WL_POLLING_INTERVAL: $IO_PAY_PORTAL_PAY_WL_POLLING_INTERVAL'
    echo 'IO_PAY_PORTAL_PAY_WL_POLLING_ATTEMPTS: $IO_PAY_PORTAL_PAY_WL_POLLING_ATTEMPTS'
    echo 'IO_PAY_PORTAL_ENV: $IO_PAY_PORTAL_ENV'
    echo 'IO_PAY_PORTAL_SITE_KEY: $IO_PAY_PORTAL_SITE_KEY'
    echo 'IO_PAY_PAYMENT_MANAGER_HOST: $IO_PAY_PAYMENT_MANAGER_HOST'
    echo 'IO_PAY_FUNCTIONS_HOST: $IO_PAY_FUNCTIONS_HOST'
    echo 'IO_PAY_API_TIMEOUT: $IO_PAY_API_TIMEOUT'
    echo 'IO_PAY_ENV: $IO_PAY_ENV'
    echo 'IO_PAY_PORTAL_API_BASEPATH: $IO_PAY_PORTAL_API_BASEPATH'
    chmod +x env.sh && source env.sh
  env:
    IO_PAY_PORTAL_API_HOST: ${{ parameters.api_host }}
    IO_PAY_PORTAL_API_REQUEST_TIMEOUT: ${{ parameters.request_timeout }}
    IO_PAY_PORTAL_PAY_WL_POLLING_INTERVAL: ${{ parameters.polling_interval }}
    IO_PAY_PORTAL_PAY_WL_POLLING_ATTEMPTS: ${{ parameters.polling_attempts }}
    IO_PAY_PORTAL_ENV: ${{ parameters.env }}
    IO_PAY_PORTAL_SITE_KEY: ${{ parameters.site_key }}
    IO_PAY_PAYMENT_MANAGER_HOST: ${{ parameters.api_host }}
    IO_PAY_FUNCTIONS_HOST: ${{ parameters.functions_host }}
    IO_PAY_API_TIMEOUT: ${{ parameters.api_timeout }}
    IO_PAY_ENV: ${{ parameters.env }}
    IO_PAY_PORTAL_API_BASEPATH: ${{ parameters.api_basepath }}
  displayName: 'Populate environment file'
